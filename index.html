<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
		<meta
		  name="viewport"
		  content="initial-scale=1, maximum-scale=1,user-scalable=no"
		/>
	<title>ABBASIYYEH</title>	
	<link rel="stylesheet" href="https://js.arcgis.com/4.14/esri/themes/light/main.css"/> 
	<script src="https://js.arcgis.com/4.14/"></script>
	   <style>
		  html,
		  body,
		  #viewDiv {
			padding: 0;
			margin: 0;
			height: 100%;
			width: 100%;
			
		  }
		
		</style>
	<script>
	require(["esri/widgets/AreaMeasurement2D","esri/widgets/DistanceMeasurement2D","esri/layers/BingMapsLayer","esri/widgets/ScaleBar","esri/widgets/Expand","esri/Map", "esri/views/MapView","esri/widgets/BasemapGallery",
	"esri/layers/FeatureLayer","esri/widgets/Legend","esri/widgets/LayerList","esri/widgets/Search","esri/widgets/Locate","esri/widgets/Home","dojo/on","dojo/domReady!"], 
		function(AreaMeasurement2D,DistanceMeasurement2D,BingMapsLayer,ScaleBar,Expand,Map, MapView,BasemapGallery,FeatureLayer,Legend,LayerList,Search,Locate,Home,on) { 
			
			var bing = new BingMapsLayer({
				style: "aerial",
				key: "Ah27iZ_4gTlzg7pSatMCOn8uCHAufMa0VRrPg3Mi7bDgyGNrjMqLcyB3yBvVXORk"
				});
			
				var map = new Map({
					basemap: {
						baseLayers: [bing]
					}
					});
			var view = new MapView({ 
				container: "viewDiv", 
				map: map, 
				zoom: 14,
				center: [35.25, 33.29], 
				});
					
				
				var measurementarea = new AreaMeasurement2D({
					view: view
					});
					var expand6 = new Expand({
					expandIconClass: "esri-icon-measure-area",
					view: view,
					content: measurementarea
					});
				var measurementWidget = new DistanceMeasurement2D({
						view: view
						});
					
					var expand5 = new Expand({
					expandIconClass: "esri-icon-measure-line",
					view: view,
					content: measurementWidget
					});

			var scaleBar = new ScaleBar({
					view: view,
					unit: "metric"
					});
					view.ui.add(scaleBar, {
					position: "bottom-left"
					});	
			var homeWidget = new Home({
				view: view
				});

				// adds the home widget to the top left corner of the MapView
				view.ui.add(homeWidget, "top-left");
			
			 var locateWidget = new Locate({
			    view: view 
			   
				});
			view.ui.add(locateWidget, "top-left");	
				var basemapGallery = new BasemapGallery({
				view: view,
				source: {
				portal: {
				url: "https://www.arcgis.com",
				useVectorBasemaps: true  
						}
				}
				});
				var expand4 = new Expand({
					expandIconClass: "esri-icon-basemap",
					view: view,
					content: basemapGallery
				});
				




				//view.ui.add(basemapGallery, "top-right");
			var template1 = {
              title: "العقارات",
			   content: [
               {
                      type: "fields",
              fieldInfos: [
                {
                  fieldName: "number",
                  label: "رقم العقار"
                },
                {
                  fieldName: "المنطقة",
                  label: "التصنيف",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
				},
				{
                  fieldName: "اسم_المنطقة",
                  label: "اسم المنطقة",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
                },
                {
                  fieldName: "Shape__Area",
                  label: "مساحة العقار م.م",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
				},
				{
                  fieldName: "الاستثمار_السطحي",
                  label: "الاستثمار السطحي",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
				},
				{
                  fieldName: "الاستثمار_العام",
                  label: "الاستثمار العام",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
				},
				{
                  fieldName: "عدد_الطوابق",
                  label: " عدد الطوابق الاقصى",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
				},
				{
                  fieldName: "neighbour_parcels",
                  label: "العقارات المجاورة",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
				},
				{
                  fieldName: "النسبة_المئوية_للانحدار",
                  label: "% نسبة انحدار العقار ",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
                },
                ]
						}
					  ]
					};	
			var template2 = {
              title: "المالكين",
			   content: [
               {
                      type: "fields",
              fieldInfos: [
                {
                  fieldName: "الرقم",
                  label: "رقم العقار"
                },
                {
                  fieldName: "اسم_المالك",
                  label: "اسم المالك",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
				},
				{
                  fieldName: "المنطقة_العقارية",
                  label: "المنطقة العقارية",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
                },
                {
                  fieldName: "القسم",
                  label: "القسم",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
				},
				{
                  fieldName: "البلوك",
                  label: " البلوك",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
				},
				{
                  fieldName: "تعيين_العقار",
                  label: "تعيين العقار",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
				},
				{
                  fieldName: "عدد_الاسهم",
                  label: " عدد الاسهم",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
				},
				{
                  fieldName: "مساحة_العقار",
                  label: "مساحة العقار",
                  format: {
                    digitSeparator: true,
                    places: 0
                  }
				},
				
                ]
						}
					  ]
					};	
			var parcels = new FeatureLayer({ 
				url: "https://services9.arcgis.com/BwlqFPXTnyyoy8fL/arcgis/rest/services/map1/FeatureServer/0?f=pjson&token=qqIOm9oGFwRFMnrTOEj-pV4xIkfExT5_7Af6I6jI6a-TLZYLm3Pd5ZGtNAF9Ubn1p52r1bnqGOlz23G1runZ5tD9F8pxzxaFhtI6eCenzv3NEt_q9Yaqx2bW1clg133tTtqGyrP4ei_LkVRx1zjcFC7ncBjkTvbuDqidmnxm5m9_JY2peigRp5JIXEkdhAfb8PwSk-5w1H3WtVes9gy12AqeLiFDhPy63_eprF_v2ygee4OO0ibaOeGvRURfzKWxpgl0f2-k3MOn_daowFFrSg.."
				,popupTemplate: template1
				});
				var owners = new FeatureLayer({ 
				url: "https://services9.arcgis.com/BwlqFPXTnyyoy8fL/arcgis/rest/services/map1/FeatureServer/4?f=pjson&token=qqIOm9oGFwRFMnrTOEj-pV4xIkfExT5_7Af6I6jI6a-TLZYLm3Pd5ZGtNAF9Ubn1p52r1bnqGOlz23G1runZ5tD9F8pxzxaFhtI6eCenzv3NEt_q9Yaqx2bW1clg133tTtqGyrP4ei_LkVRx1zjcFC7ncBjkTvbuDqidmnxm5m9_JY2peigRp5JIXEkdhAfb8PwSk-5w1H3WtVes9gy12AqeLiFDhPy63_eprF_v2ygee4OO0ibaOeGvRURfzKWxpgl0f2-k3MOn_daowFFrSg.."
				,popupTemplate: template2
				});
				map.add(parcels);
				map.add(owners);
				
			var legend = new Legend({
				view: view, 
				layerInfos: [ { layer: parcels,title: "parcels" }], });
				var expand3 = new Expand({
					expandIconClass: "esri-icon-feature-layer",
					view: view,
					content: legend
				});
				

			var searchWidget = new Search({
				  view: view,
				  allPlaceholder: "بحث",
				  sources: [
					{
					  layer: parcels,
					  searchFields: ["رقم_العقار"],
					  displayField: "رقم_العقار",
					  exactMatch: true,
					  outFields: ["رقم_العقار", "اسم_المنطقة","المنطقة", "Shape__Area","تعيين_العقار", "عدد_المالكين","حدود_العقار"],
					  name: "رقم العقار",
					  placeholder: "بحث عن عقار"
					},
					{
					  layer: owners,
					  searchFields: ["اسم_المالك"],
					  displayField: "اسم_المالك",
					  exactMatch: false,
					  outFields: ["*"],
					  name: "اسم المالك ",
					  placeholder: "اسم المالك"
					},
					]
					});
					
					var expand1 = new Expand({
					expandIconClass: "esri-icon-search",
					view: view,
					content: searchWidget
				});
				


			var layerList = new LayerList({ view: view });
			var expand2 = new Expand({
					expandIconClass: "esri-icon-layer-list",
					title: "basemaps",
					view: view,
					content: layerList
				});

				view.ui.add(expand1, "top-right");
				view.ui.add(expand4, "top-right");
				view.ui.add(expand2, "top-right");
				view.ui.add(expand3, "top-right");
				view.ui.add(expand5, "top-right");
				view.ui.add(expand6, "top-right");
				
			
			
		   
	});
	
</script>

</head>

<body>
<div id="viewDiv"></div>
</body>
</html>